{"version":3,"sources":["uni-app:///main.js",null,"webpack:///D:/server/outIm/imClient/imClient/pages/index/chat.vue?1e4d","webpack:///D:/server/outIm/imClient/imClient/pages/index/chat.vue?e456","webpack:///D:/server/outIm/imClient/imClient/pages/index/chat.vue?b6f7","uni-app:///pages/index/chat.vue"],"names":["createPage","Page"],"mappings":";;;;;;;;;;kDAAA;AACA;AACA,0F;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACHA;AAAA;AAAA;AAAA;AAAA;AAAiH;AACjH;AACwD;AACL;;;AAGnD;AACyK;AACzK,gBAAgB,6KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,+EAAM;AACR,EAAE,wFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,mFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACtBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAA+nB,CAAgB,8mBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC2FnpB;AACA,gD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAFA,mB,eAMA,EACA,IADA,kBACA,CACA,SACA,+BADA,EAEA,iBAFA,EAGA,cAHA,EAIA,WAJA,GAMA,CARA,EASA,MATA,kBASA,OATA,EASA,CACA,gBACA,qBACA,+BACA,sBAJA,CAKA;AACA,uBACA,mBADA,IAIA,CAnBA,EAoBA,wCAEA,CAtBA,EAuBA,0CAGA,0CAHA,SAIA,UAJA,wBAIA,CACA,gBADA,CAEA;AACA,sFACA;AACA,uDACA;AACA,6BACA,mBADA,IAGA,CACA,CARA,EAQA,IARA,GASA,sCACA,CAjBA,GAvBA,EA0CA,SACA,gBACA;AACA,mCACA,gBACA,2BACA,uBAEA,CAPA,EADA,EA1CA,EAsDA,WACA,4BACA,CAEA,CAJA,EAKA,wBACA,CAEA,CARA,EASA,UATA,sBASA,CATA,EASA,CACA,mCACA,CAXA,EAYA,SAZA,qBAYA,CAZA,EAYA,CACA,qBACA,CAdA,EAeA,UAfA,sBAeA,CAfA,EAeA,CACA,gBACA,8BACA,kBACA,OACA,CACA,6CACA,aADA,EAEA,sBAFA,EAGA,UAHA,EAIA,OAJA,IAKA,gBACA;AACA,4HAFA,CAGA;AACA;AACA,OAVA,EAWA,CAhCA,EAiCA,QAjCA,sBAiCA,CACA,sBACA,8BAFA,CAEA;AACA,sCAHA,CAGA;AACA,+BAJA,CAIA;AACA,kCALA,CAKA;AACA,sCANA,CAMA;AACA,sCAPA,CAOA;AACA;AACA,qGATA,CAUA;AACA,qCACA,oBACA;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KArEA,EAtDA,E","file":"pages/index/chat.js","sourcesContent":["import 'uni-pages';\nimport Vue from 'vue'\nimport Page from './pages/index/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=f16335a4&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/index/chat.vue\"\nexport default component.exports","export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=f16335a4&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\r\n    <view>\r\n        <!-- <cu-custom bgColor=\"bg-gradual-pink\" :isBack=\"true\"><block slot=\"backText\">返回</block><block slot=\"content\">聊天</block></cu-custom> -->\r\n\t\t<view class=\"cu-chat\">\r\n            <view v-for=\"(item,index) in talkDetail\" :key=\"index\">\r\n                <view v-bind:class=\"[item.postid == uid ? 'self' : '', 'cu-item']\">\r\n\t\t\t\t\t<view class=\"main\" v-if=\"item.postid == uid\">\r\n\t\t\t\t\t\t<view class=\"content bg-green shadow\" >\r\n\t\t\t\t\t\t\t<text>{{item.content}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"cu-avatar radius\" style=\"background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big107000.jpg);\"></view>\r\n\t\t\t\t\t<view class=\"main\" v-if=\"item.postid != uid\">\r\n\t\t\t\t\t\t<view class=\"content  shadow\" >\r\n\t\t\t\t\t\t\t<text>{{item.content}}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"date\">{{item.date}}</view>\r\n\t\t\t\t</view>\r\n            </view>\r\n\t\t\t\r\n\t\t\t<!-- <view class=\"cu-info\">\r\n\t\t\t\t<text class=\"cuIcon-roundclosefill text-red \"></text> 对方拒绝了你的消息\r\n\t\t\t</view> -->\r\n\t\t\t<!-- <view class=\"cu-info\">\r\n\t\t\t\t对方开启了好友验证，你还不是他(她)的好友。请先发送好友验证请求，对方验证通过后，才能聊天。\r\n\t\t\t\t<text class=\"text-blue\">发送好友验证</text>\r\n\t\t\t</view> -->\r\n\t\t\t<!-- <view class=\"cu-item self\">\r\n\t\t\t\t<view class=\"main\">\r\n\t\t\t\t\t<image src=\"https://ossweb-img.qq.com/images/lol/web201310/skin/big10006.jpg\" class=\"radius\" mode=\"widthFix\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"cu-avatar radius\" style=\"background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big107000.jpg);\"></view>\r\n\t\t\t\t<view class=\"date\"> 13:23</view>\r\n\t\t\t</view> -->\r\n\t\t\t<!-- <view class=\"cu-item self\">\r\n\t\t\t\t<view class=\"main\">\r\n\t\t\t\t\t<view class=\"action text-bold text-grey\">\r\n\t\t\t\t\t\t3\"\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"content shadow\">\r\n\t\t\t\t\t\t<text class=\"cuIcon-sound text-xxl padding-right-xl\"> </text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"cu-avatar radius\" style=\"background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big107000.jpg);\"></view>\r\n\t\t\t\t<view class=\"date\">13:23</view>\r\n\t\t\t</view> -->\r\n\t\t\t<!-- <view class=\"cu-item self\">\r\n\t\t\t\t<view class=\"main\">\r\n\t\t\t\t\t<view class=\"action\">\r\n\t\t\t\t\t\t<text class=\"cuIcon-locationfill text-orange text-xxl\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"content shadow\">\r\n\t\t\t\t\t\t喵星球，喵喵市\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"cu-avatar radius\" style=\"background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big107000.jpg);\"></view>\r\n\t\t\t\t<view class=\"date\">13:23</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"cu-item\">\r\n\t\t\t\t<view class=\"cu-avatar radius\" style=\"background-image:url(https://ossweb-img.qq.com/images/lol/web201310/skin/big143004.jpg);\"></view>\r\n\t\t\t\t<view class=\"main\">\r\n\t\t\t\t\t<view class=\"content shadow\">\r\n\t\t\t\t\t\t@#$^&**\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"action text-grey\">\r\n\t\t\t\t\t\t<text class=\"cuIcon-warnfill text-red text-xxl\"></text> <text class=\"text-sm margin-left-sm\">翻译错误</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"date\">13:23</view>\r\n\t\t\t</view> -->\r\n\t\t\t<view class=\"bottom\" id=\"bottom\"></view>\r\n\t\t</view>\r\n\t\t<form @submit=\"formSubmit\" @reset=\"formReset\">\r\n\t\t<view class=\"cu-bar foot input\" :style=\"[{bottom:InputBottom+'px'}]\">\r\n\t\t\t<view class=\"action\">\r\n\t\t\t\t<text class=\"cuIcon-sound text-grey\"></text>\r\n\t\t\t</view>\r\n\t\t\t<input name=\"msg\" class=\"solid-bottom\" :adjust-position=\"false\" :focus=\"false\" maxlength=\"300\" cursor-spacing=\"10\"\r\n\t\t\t @focus=\"InputFocus\" @blur=\"InputBlur\"></input>\r\n\t\t\t<view class=\"action\">\r\n\t\t\t\t<text class=\"cuIcon-emojifill text-grey\"></text>\r\n\t\t\t</view>\r\n\t\t\t<button form-type=\"submit\" class=\"cu-btn bg-green shadow\">发送</button>\r\n\t\t</view>\r\n\t\t</form>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\n\tconst app = getApp();\r\n    import server from '@/node_modules/prettier/server.js';\r\n    import {\r\n        mapState,\r\n        mapMutations  \r\n    } from 'vuex';\r\n\texport default {\r\n\t\tdata() {\r\n\t\treturn {\r\n\t\t\t\tscroolHeight:this.scroolHeight,\r\n\t\t\t\tPageCur: 'basics',\r\n                InputBottom: 0,\r\n\t\t\t\tfrom_id:'',\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tvar that = this;\r\n            console.log(options)\r\n\t\t\tthat.from_id = options.from_id\r\n\t\t\tvar key = options.key;\r\n            // this.$store.commit('takeTalkDetail',key)\r\n\t\t\tuni.pageScrollTo({\r\n\t\t\t\tselector : '#bottom'\r\n\t\t\t})\r\n            \r\n\t\t},\r\n\t\tonPageScroll: function (e) {\r\n\t\t\t\r\n\t\t},\r\n        computed: {\r\n\t\t\t\r\n            //监听接收到的消息\r\n            ...mapState(['talkDetail','uid']),\r\n            socketMsgs() {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\t//接收到本页面信息时需要判断是否需要滚动,如果滑动距离大于一个屏幕高度则不滚动,反之滚动到底,自己发消息点击输入框则滚动到底(即底部锚点距离上部高于2个可显示高度)\r\n                uni.createSelectorQuery().select('#bottom').boundingClientRect(function (rect) {\r\n\t\t\t\t\t//聊天记录高度\r\n\t\t\t\t\tif ( (rect.bottom  - that.scroolHeight * 2) <= 0) {\r\n\t\t\t\t\t\t// 使页面滚动到底部\r\n\t\t\t\t\t\tuni.pageScrollTo({\r\n\t\t\t\t\t\t\tselector : '#bottom'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t}).exec()\r\n\t\t\t\treturn this.$store.getters.socketMsgs\r\n            }\r\n        },\r\n        watch: {\r\n            'socketMsgs': {\r\n                //处理接收到的消息\r\n                handler: function() {\r\n                    let that = this\r\n                    let sMsg = that.socketMsgs\r\n                    console.log('聊天页面的接收')\r\n                    \r\n                }\r\n            }\r\n        },\r\n\r\n        methods:{\r\n            regiest:function()\r\n            {\r\n               \r\n            },\r\n            login:function()\r\n            {\r\n                \r\n            },\r\n            InputFocus(e) {\r\n\t\t\t\tthis.InputBottom = e.detail.height\r\n\t\t\t},\r\n\t\t\tInputBlur(e) {\r\n\t\t\t\tthis.InputBottom = 0\r\n\t\t\t},\r\n\t\t\tformSubmit(e) {\r\n\t\t\t\tvar that = this;\r\n\t\t\t\tvar data = e.detail.value.msg;\r\n\t\t\t\tif (data === '') {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tserver.postJSON('/api/sendToUid',{\r\n\t\t\t\t\tuid:that.uid,\r\n\t\t\t\t\totheruid:that.from_id,\r\n\t\t\t\t\tdata:data,\r\n\t\t\t\t\ttype:1,\r\n\t\t\t\t},function(res){\r\n\t\t\t\t\t//result.data.from_id, result.data.type, result.data.data, result.data.date\r\n\t\t\t\t\tthat.$store.commit('saveTalkData',{data:{from_id:that.from_id,type:1,date:that.makeDate(),data:data}});\r\n\t\t\t\t\t// console.log(res);\r\n\t\t\t\t\t//将发送内容插入到本地存储中\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tmakeDate() {\r\n\t\t\t\tvar date = new Date();\r\n\t\t\t\tvar year = date.getFullYear();        //年 ,从 Date 对象以四位数字返回年份\r\n\t\t\t\tvar month = date.getMonth() + 1;      //月 ,从 Date 对象返回月份 (0 ~ 11) ,date.getMonth()比实际月份少 1 个月\r\n\t\t\t\tvar day = date.getDate();             //日 ,从 Date 对象返回一个月中的某一天 (1 ~ 31)\r\n\t\t\t\tvar hours = date.getHours();          //小时 ,返回 Date 对象的小时 (0 ~ 23)\r\n\t\t\t\tvar minutes = date.getMinutes();      //分钟 ,返回 Date 对象的分钟 (0 ~ 59)\r\n\t\t\t\tvar seconds = date.getSeconds();      //秒 ,返回 Date 对象的秒数 (0 ~ 59)   \r\n\t\t\t\t//获取当前系统时间  \r\n\t\t\t\tvar currentDate = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\r\n\t\t\t\t//修改月份格式\r\n\t\t\t\tif (month >= 1 && month <= 9) {\r\n\t\t\t\t\tmonth = \"0\" + month;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//修改日期格式\r\n\t\t\t\tif (day >= 0 && day <= 9) {\r\n\t\t\t\t\tday = \"0\" + day;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//修改小时格式\r\n\t\t\t\tif (hours >= 0 && hours <= 9) {\r\n\t\t\t\t\thours = \"0\" + hours;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//修改分钟格式\r\n\t\t\t\tif (minutes >= 0 && minutes <= 9) {\r\n\t\t\t\t\tminutes = \"0\" + minutes;\r\n\t\t\t\t}\r\n\t\t\t\t//修改秒格式\r\n\t\t\t\tif (seconds >= 0 && seconds <= 9) {\r\n\t\t\t\t\tseconds = \"0\" + seconds;\r\n\t\t\t\t}\r\n\t\t\t\t//获取当前系统时间  格式(yyyy-mm-dd hh:mm:ss)\r\n\t\t\t\tvar currentFormatDate = year + \"-\" + month + \"-\" + day + \" \" + hours + \":\" + minutes + \":\" + seconds;\r\n\t\t\t\treturn currentFormatDate;\r\n\t\t\t}\r\n        }\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\r\n</style>\r\n"],"sourceRoot":""}